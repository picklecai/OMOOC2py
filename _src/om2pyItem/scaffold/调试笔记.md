# 调试笔记  

## 1. submit和button的区别  
[input type="submit" 和"button"有什么区别？ - 知乎](https://www.zhihu.com/question/20839977)  
> 在一个页面上画一个按钮，有四种办法：  
> 
>  `<input type="button" />` 这就是一个按钮。如果你不写javascript 的话，按下去什么也不会发生。  
> 
> `<input type="submit" />` 这样的按钮用户点击之后会自动提交 form，除非你写了javascript 阻止它。   
> 
> `<button>` 这个按钮放在 form 中也会点击自动提交，比前两个的优点是按钮的内容不光可以有文字，还可以有图片等多媒体内容。（当然，前两个用图片背景也可以做到）。它的缺点是不同的浏览器得到的 value 值不同；可能还有其他的浏览器兼容问题（葛亮）。  
> 
> 其他标签，例如 a, img, span, div，然后用图片把它伪装成一个按钮。  

用法：  
> 表单数据这个特性，是无法混淆的。`<button>`无法把自己当成Form的数据。  
> 所以，如果只是个单纯的按钮，触发一些画面动作，请使用`<button>`；  
> 反之，会把画面的数据提交给Server的，一般用`<input type="submit" />`，当然`<button>`+JS也完全可以取代。   

## 2. get和post的区别   
[Tutorial — Bottle 0.13-dev documentation](http://bottlepy.org/docs/dev/tutorial.html#request-data)   

> The action attribute specifies the URL that will receive the form data. method defines the HTTP method to use (GET or POST).   
> With method="get" the form values are **appended to the URL** and available through BaseRequest.query as described above. This is considered insecure and has other limitations, so we use method="post" here. If in doubt, use POST forms.

## 3.数字形式的时间转为时间格式  
[Python time strptime() Method](http://www.tutorialspoint.com/python/time_strptime.htm)  

    #!/usr/bin/python
	import time
	
	struct_time = time.strptime("30 Nov 00", "%d %b %y")
	print "returned tuple: %s " % struct_time

格式符意义：  
> %a - abbreviated weekday name  
%A - full weekday name  
%b - abbreviated month name  
%B - full month name  
%d - day of the month (01 to 31)  
%H - hour, using a 24-hour clock (00 to 23)  
%I - hour, using a 12-hour clock (01 to 12)  
%M - minute  
%y - year without a century (range 00 to 99)  

## 4. baby页面  

html文件中，  

    <form action="/baby.html" method="GET">  
方法定为GET。  

main.py中，  

    @app.route('/baby.html', method='GET')  
方法定为GET。  

运行500错误：  
![](http://7xotr7.com1.z0.glb.clouddn.com/15-12-16/29745709.jpg)  

原因是加号不能用在这里。  

之前只看到405或500，没发现问题代码。  

加上str（）转换，代码改为：  

    birthtime = time.strptime(str(request.forms.get('date'))+'/'+str(request.forms.get('month'))+'/'+str(request.forms.get('year')), "%d/%m/%Y")  

500错误为：  
![](http://7xotr7.com1.z0.glb.clouddn.com/15-12-17/29359471.jpg)  

查看striptime的文档：  
> time.striptime(string[, format])  

参数要求是string。现在str()转换出来的被系统认为是none。  

绕过这个问题，代码改为：  

     birthtime = time.strftime("%d/%m/%Y %H:%M:%S")  

现在问题代码是：  

    data = name.decode('utf-8'), gender.decode('utf-8'), birthtime.decode('utf-8')  

500提示是：  
![](http://7xotr7.com1.z0.glb.clouddn.com/15-12-17/35234971.jpg)  

再绕过去，代码改为：  

    data = name, gender, birthtime  

界面不再500.  
打开baby页面，填入信息，打印信息刚出现即消失。可以看到打印出来的信息是：  

> none,none,(当前时间)  

打印信息还可以看到的问题是：这里的打印方法用了和打印记录相同的方法，但是现在只录入一个宝宝，不应该有多行记录。应该是录入一次信息后，后来都变成修改模式保存最新。

这说明不但birthtime的写法被认为是none，连界面读取出来的text也被认为是none。  

另外，由于baby页面是get方法，所以可以看到不再500之后的baby页面网址：  
![](http://7xotr7.com1.z0.glb.clouddn.com/15-12-17/22143236.jpg)    
![](http://7xotr7.com1.z0.glb.clouddn.com/15-12-17/78667476.jpg)  
所填参数悉数体现在url中。  

[执行python脚本时，返回：AttributeError: 'NoneType' object has no attribute 'open_session'，原因？_百度知道](http://zhidao.baidu.com/question/499301263.html)  
这里说：  
> NoneType的本意是 （变量的值是）空的值.所以，值都是空的了，当然没有相关的各种属性  

所以name和gender可能没有收到传值，所以是none。但是为什么又已经被get到了url中了呢？  

重新考虑一下，在刚刚打开baby页面时，确实这些值都是none。而现在程序走的顺序是：先确认这些值不是none，才允许打开页面，再输入。应该做到让baby页面打开时，不去碰这一段代码，直接打开。  

在首页，首先用get方法打开的是“/”页面，然后采用post方法打开并返回“/index”,运行和输入数据相关的save函数。所以打开“/”时，不会产生任何none类错误。  